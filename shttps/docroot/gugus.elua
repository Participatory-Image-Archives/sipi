<html>
<head>
  <meta charset="UTF-8">
  <title>Embedded lua test</title>
</head>
<body>
<h1>Embedded lua test</h1>
<hr/>

<lua>

result = server.http("GET", "http://www.salsah.org/api/resources/1", 1000)

if (result.success) then
    server.print("<table>")
    server.print("<tr><th>Field</th><th>Value</th></tr>")
    for k,v in pairs(server.header) do
        server.print("<tr><td>", k, "</td><td>", v, "</td></tr>")
    end
    server.print("</table><hr/>")

    server.print("Duration: ", result.duration, " ms<br/><hr/>")
    server.print("Body:<br/>", result.body)
else
   server.print("ERROR: ", result.errmsg)
end

</lua>

</body>
</html>
